parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KIzB":[function(require,module,exports) {
"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var r=function r(){e(this,r)};r.fieldOfGame=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r.fieldSize=r.fieldOfGame.length,r.movable=!1,r.countMovedCells=0,r.numberOfMergeableCells=0,r.currentScore=0,r.startMessage=document.querySelector(".message-start"),r.winMessage=document.querySelector(".message-win"),r.loseMessage=document.querySelector(".message-lose"),r.fieldRows=document.querySelector(".game-field").rows,r.scoreboard=document.querySelector(".game-score"),r.findEmptyCells=function(){for(var e=[],a=0;a<r.fieldSize;a++)for(var i=0;i<r.fieldSize;i++)0===r.fieldOfGame[a][i]&&e.push("".concat(a).concat(i));return 0===e.length?r.movable=!1:r.movable=!0,e},r.defineCreatingCellValue=function(){return 4===parseInt(10*Math.random())+1?4:2},r.findCoordsForNewCell=function(){var e=r.findEmptyCells();return e[parseInt(Math.random()*e.length)].split("")},r.createCell=function(){var e=r.findCoordsForNewCell();r.fieldOfGame[+e[0]][+e[1]]=r.defineCreatingCellValue()},r.startGame=function(){r.countMovedCells=0,r.currentScore=0,r.clearCells(),r.createCell(),r.createCell(),r.render("start","start"),document.addEventListener("keydown",r.handleArrowPress)},r.clearCells=function(){for(var e=0;e<r.fieldSize;e++)for(var a=0;a<r.fieldSize;a++)r.fieldOfGame[e][a]=0},r.changeCellClass=function(e,r){e.classList.contains("field-cell--".concat(e.innerText))&&e.classList.remove("field-cell--".concat(e.innerText)),0!==r&&e.classList.add("field-cell--".concat(r))},r.renderfieldOfGame=function(){for(var e=0;e<r.fieldSize;e++)for(var a=0;a<r.fieldSize;a++)0!==r.fieldOfGame[e][a]?(r.changeCellClass(r.fieldRows[e].cells[a],r.fieldOfGame[e][a]),r.fieldRows[e].cells[a].innerText=r.fieldOfGame[e][a]):(r.changeCellClass(r.fieldRows[e].cells[a],r.fieldOfGame[e][a]),r.fieldRows[e].cells[a].innerText="")},r.renderMesage=function(e){switch(e){case"win":r.winMessage.classList.remove("hidden");break;case"lose":r.loseMessage.classList.remove("hidden");break;case"prepareForStart":r.winMessage.classList.add("hidden"),r.loseMessage.classList.add("hidden"),r.startMessage.classList.remove("hidden");break;case"start":r.startMessage.classList.add("hidden"),r.winMessage.classList.add("hidden"),r.loseMessage.classList.add("hidden")}},r.renderButton=function(e){var a=document.querySelector(".start");switch(e){case"prepareForStart":a.addEventListener("click",function(){return r.startGame()}),a.classList.add("start"),a.innerText="Start",a.blur();break;case"start":if(a)a.classList.remove("start"),a.classList.add("restart"),a.innerText="Restart",a.blur();else document.querySelector(".restart").blur()}},r.render=function(e,a){r.renderfieldOfGame(),r.scoreboard.innerText=r.currentScore,r.renderMesage(e),r.renderButton(a)},r.createMatrixClone=function(){for(var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],a=0;a<r.fieldSize;a++)for(var i=0;i<r.fieldSize;i++)e[a][i]=r.fieldOfGame[a][i];return e},r.getTargetValue=function(e,a,i,t){var n;switch(a){case"left":n=e[t][r.fieldSize-i-1];break;case"right":n=e[r.fieldSize-t-1][i];break;case"down":n=e[r.fieldSize-i-1][t]}return n},r.rotateMatrix=function(e){for(var a=r.createMatrixClone(r.fieldOfGame),i=0;i<r.fieldSize;i++)for(var t=0;t<r.fieldSize;t++)r.fieldOfGame[i][t]=r.getTargetValue(a,e,i,t)},r.moveCells=function(){for(var e=r.fieldSize-1;e>0;e--)for(var a=0;a<r.fieldSize;a++)0===r.fieldOfGame[e-1][a]&&0!==r.fieldOfGame[e][a]&&(r.fieldOfGame[e-1][a]=r.fieldOfGame[e][a],r.fieldOfGame[e][a]=0,r.countMovedCells++)},r.mergeCells=function(){for(var e=0;e<r.fieldSize-1;e++)for(var a=0;a<r.fieldSize;a++)r.fieldOfGame[e][a]===r.fieldOfGame[e+1][a]&&0!==r.fieldOfGame[e][a]&&(r.fieldOfGame[e][a]=2*r.fieldOfGame[e+1][a],r.fieldOfGame[e+1][a]=0,r.currentScore+=r.fieldOfGame[e][a],r.countMovedCells++)},r.makeChanges=function(){for(var e=0;e<r.fieldSize-1;e++)r.moveCells();r.mergeCells();for(var a=0;a<r.fieldSize-1;a++)r.moveCells()},r.findCellsForMerge=function(){for(var e=0;e<r.fieldSize-1;e++)for(var a=0;a<r.fieldSize;a++)if(0!==r.fieldOfGame&&r.fieldOfGame[e][a]===r.fieldOfGame[e+1][a])return void r.numberOfMergeableCells++;for(var i=0;i<r.fieldSize;i++)for(var t=0;t<r.fieldSize-1;t++)if(0!==r.fieldOfGame&&r.fieldOfGame[i][t]===r.fieldOfGame[i][t+1])return void r.numberOfMergeableCells++},r.checkWinScenario=function(){for(var e=0;e<r.fieldSize;e++)for(var a=0;a<r.fieldSize;a++)if(2048===r.fieldOfGame[e][a])return!0},r.checkLoseScenario=function(){if(!r.movable&&0===r.numberOfMergeableCells)return!0},r.prepareForNewRound=function(){document.addEventListener("keydown",r.handleArrowPress),r.countMovedCells=0,r.movable=!1,r.numberOfMergeableCells=0,r.render("start","start")},r.finishRound=function(){if(0!==r.countMovedCells){if(document.removeEventListener("keydown",r.handleArrowPress),r.checkWinScenario())return r.render("start","start"),void setTimeout(function(){r.finishGame("win")},1e3);setTimeout(r.createCell,200),setTimeout(function(){if(r.findEmptyCells(),r.findCellsForMerge(),r.checkLoseScenario())return r.render("start","start"),void r.finishGame("lose");r.prepareForNewRound()},300)}},r.finishGame=function(e){document.removeEventListener("keydown",r.handleArrowPress),r.clearCells(),r.currentScore=0,"win"===e?r.render("win","start"):r.loseMessage.classList.remove("hidden")},r.handleArrowPress=function(e){switch(e.preventDefault(),e.code){case"ArrowUp":r.makeChanges(),r.finishRound();break;case"ArrowDown":r.rotateMatrix("down"),r.makeChanges(),r.rotateMatrix("down"),r.finishRound();break;case"ArrowLeft":r.rotateMatrix("right"),r.makeChanges(),r.rotateMatrix("left"),r.finishRound();break;case"ArrowRight":r.rotateMatrix("left"),r.makeChanges(),r.rotateMatrix("right"),r.finishRound()}},r.render("prepareForStart","prepareForStart");
},{}]},{},["KIzB"], null)
//# sourceMappingURL=main.fc50dde5.js.map